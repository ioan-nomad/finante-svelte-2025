<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N-OMAD Suite - Test Runner</title>
</head>
<body>
  <h1>N-OMAD Suite - Integration Test Runner</h1>
  <p>Deschide Developer Console (F12) pentru a vedea rezultatele testelor.</p>

  <script type="module">
    console.log('🔬 N-OMAD Suite Test Runner Starting...');

    // Test 1: Check Module Loading
    async function testModules() {
      console.log('\n📦 Testing Module Loading...');

      try {
        const modules = [
          './src/modules/nutrition/analytics/AnalyticsEngine.js',
          './src/modules/testing/IntegrationTester.js'
        ];

        for (const path of modules) {
          const module = await import(path);
          console.log(`✅ Loaded: ${path}`);
        }

        return true;
      } catch (error) {
        console.error('❌ Module loading failed:', error);
        return false;
      }
    }

    // Test 2: Run Integration Tests
    async function runIntegrationTests() {
      console.log('\n🧪 Running Integration Tests...');

      try {
        const { integrationTester } = await import('./src/modules/testing/IntegrationTester.js');

        // Check production readiness
        const readiness = await integrationTester.checkProductionReadiness();

        console.log('\n📊 Production Readiness Check:');
        console.log(`Score: ${readiness.score}%`);
        console.log(`Ready: ${readiness.ready ? '✅ YES' : '❌ NO'}`);

        readiness.checks.forEach(check => {
          console.log(`${check.status} ${check.name}`);
        });

        return readiness;
      } catch (error) {
        console.error('❌ Integration tests failed:', error);
        return null;
      }
    }

    // Test 3: Check localStorage Data
    function checkLocalStorage() {
      console.log('\n💾 Checking localStorage...');

      const keys = [
        'groceryInventory',
        'nutritionProfile',
        'mtor_cycles',
        'generated_recipes',
        'meal_history',
        'fs_data'
      ];

      keys.forEach(key => {
        const data = localStorage.getItem(key);
        if (data) {
          try {
            const parsed = JSON.parse(data);
            const size = new Blob([data]).size;
            console.log(`✅ ${key}: ${(size / 1024).toFixed(2)} KB`);
          } catch {
            console.log(`⚠️ ${key}: Invalid JSON`);
          }
        } else {
          console.log(`❌ ${key}: Not found`);
        }
      });
    }

    // Run all tests
    async function runAllTests() {
      console.log('════════════════════════════════════════');
      console.log('   N-OMAD SUITE - COMPLETE TEST SUITE   ');
      console.log('════════════════════════════════════════');

      await testModules();
      checkLocalStorage();
      const readiness = await runIntegrationTests();

      console.log('\n════════════════════════════════════════');
      if (readiness && readiness.ready) {
        console.log('🎉 PRODUCTION READY! All tests passed!');
      } else {
        console.log('⚠️ Not production ready. Check failed tests above.');
      }
      console.log('════════════════════════════════════════');
    }

    // Auto-run tests
    runAllTests();
  </script>
</body>
</html>